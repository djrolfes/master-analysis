# Master Analysis

This repository contains code for the automated delegation of jobs and analysis of data generated by the `klft` code.

## Project Structure

-   `.gitsubmodules`: This file tracks the submodules included in this repository.
-   `analysis/`: Contains Python scripts for analyzing the output data.
    -   `analysis.py`: An example analysis script that reads an input YAML and checks for output files.
-   `extern/`: Contains external code included as Git submodules.
    -   `klft/`: The `klft` submodule for data generation.
-   `inputs/`: Contains example input `.yaml` files for the `klft` code.
    -   `input.yaml`: An example input file.
-   `scripts/`: Contains bash scripts for job submission.
    -   `run_job.sh`: An example SLURM submission script.

## Workflow

1.  **Prepare Input**: Create or modify an input `.yaml` file in the `inputs/` directory. This file specifies the parameters for the `klft` simulation.

2.  **Submit Job**: Use the `scripts/run_job.sh` script to submit a job to the SLURM cluster. This script will:
    -   Create a unique output directory.
    -   Copy the input `.yaml` file to the output directory.
    -   Run the `klft` simulation.
    -   Submit a dependent analysis job that runs after the simulation is complete.

    Example usage:
    ```bash
    sbatch scripts/run_job.sh inputs/input.yaml
    ```

3.  **Analyze Data**: The `analysis.py` script is automatically triggered after the simulation. It reads the `input.yaml` from the output directory and can perform analysis based on the generated files. You can also run it manually:
    ```bash
    python analysis/analysis.py <output_directory>
    ```

## Submodules

This repository uses Git submodules to include external code. To clone this repository and initialize the submodules, use:

```bash
git clone --recurse-submodules https://github.com/djrolfes/master-analysis.git
```

If you have already cloned the repository, you can initialize the submodules with:

```bash
git submodule update --init --recursive
```
